databaseChangeLog:
  - changeSet:
      id: 01_create_table_customer
      author: dipdeepcode
      preConditions:
        - onFail: MARK_RAN
          not:
            - tableExists:
                tableName: customer
      changes:
        - sql:
            sql: 'CREATE TABLE customer
                  (
                    id         BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                    last_name  VARCHAR(255)                            NOT NULL,
                    first_name VARCHAR(255)                            NOT NULL,
                    CONSTRAINT pk_customer PRIMARY KEY (id)
                  );'
  - changeSet:
      id: 02_create_table_balance
      author: dipdeepcode
      preConditions:
        - onFail: MARK_RAN
          not:
            - tableExists:
                tableName: balance
      changes:
        - sql:
            sql: 'CREATE TABLE balance
                  (
                      id          BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                      customer_id BIGINT                                  NOT NULL,
                      CONSTRAINT pk_balance PRIMARY KEY (id)
                  );'
  - changeSet:
      id: 03_create_fk_balance_on_customer
      author: dipdeepcode
      preConditions:
        - onFail: MARK_RAN
          not:
            - foreignKeyConstraintExists:
                foreignKeyName: fk_balance_on_customer
      changes:
        - sql:
            sql: 'ALTER TABLE balance
                      ADD CONSTRAINT FK_BALANCE_ON_CUSTOMER FOREIGN KEY (customer_id) REFERENCES customer (id);'