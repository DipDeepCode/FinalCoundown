databaseChangeLog:
  - changeSet:
      id: 01_create_table_customer
      author: dipdeepcode
      preConditions:
        - onFail: MARK_RAN
          not:
            - tableExists:
                tableName: customer
      changes:
        - sql:
            sql: 'CREATE TABLE customer
                  (
                      id         BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                      firstname  VARCHAR(255)                            NOT NULL,
                      lastname   VARCHAR(255)                            NOT NULL,
                      balance_id BIGINT                                  NOT NULL,
                      CONSTRAINT pk_customer PRIMARY KEY (id)
                  );'
  - changeSet:
      id: 02_create_table_balance
      author: dipdeepcode
      preConditions:
        - onFail: MARK_RAN
          not:
            - tableExists:
                tableName: balance
      changes:
        - sql:
            sql: 'CREATE TABLE balance
                  (
                      id      BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                      balance BIGINT                                  NOT NULL,
                      CONSTRAINT pk_balance PRIMARY KEY (id)
                  );'
  - changeSet:
      id: 03_create_fk_customer_on_balance
      author: dipdeepcode
      preConditions:
        - onFail: MARK_RAN
          not:
            - foreignKeyConstraintExists:
                foreignKeyName: fk_customer_on_balance
      changes:
        - sql:
            sql: 'ALTER TABLE customer
                      ADD CONSTRAINT FK_CUSTOMER_ON_BALANCE FOREIGN KEY (balance_id) REFERENCES balance (id);'